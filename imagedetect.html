<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SustainX ‚Äî Smart Detection</title>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=Plus+Jakarta+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

    :root {
      --bg:      #080c10;
      --surf:    #0d1219;
      --border:  rgba(255,255,255,0.07);
      --green:   #00e5a0;
      --gdim:    rgba(0,229,160,0.14);
      --amber:   #f5a623;
      --red:     #ff4c6a;
      --purple:  #a78bfa;
      --text:    #eef2f7;
      --muted:   #7a8fa8;
      --head:    'Outfit', sans-serif;
      --body:    'Plus Jakarta Sans', sans-serif;
    }

    html, body { height: 100%; }

    body {
      font-family: var(--body);
      background: var(--bg);
      color: var(--text);
      overflow: hidden;          /* key fix ‚Äî no page scroll, panels scroll */
    }

    /* scanline texture */
    body::before {
      content:''; position:fixed; inset:0;
      background: repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,0.03) 2px,rgba(0,0,0,0.03) 4px);
      pointer-events:none; z-index:9999;
    }

    /* ‚îÄ‚îÄ NAV ‚îÄ‚îÄ */
    nav {
      position:fixed; top:0; left:0; right:0; z-index:600;
      height:64px; padding:0 2.5rem;
      display:flex; align-items:center; justify-content:space-between;
      background:rgba(8,12,16,0.9); backdrop-filter:blur(18px);
      border-bottom:1px solid var(--border);
    }
   .nav-logo {
  font-family:var(--head); font-size:1.5rem; font-weight:800;
  background:linear-gradient(135deg,var(--green),var(--purple));
  -webkit-background-clip:text;
  background-clip:text;
  -webkit-text-fill-color:transparent;
  color:transparent;
  text-decoration:none; letter-spacing:-0.02em;
}
    .nav-right { display:flex; align-items:center; gap:1.25rem; }
    .nav-tag {
      font-family:var(--head); font-size:0.82rem; font-weight:600;
      color:var(--green); background:var(--gdim);
      border:1px solid rgba(0,229,160,0.25);
      padding:0.35rem 0.9rem; border-radius:99px; letter-spacing:0.04em;
    }
    .nav-back {
      font-family:var(--head); font-size:0.9rem; font-weight:600;
      color:var(--muted); background:none;
      border:1px solid var(--border); padding:0.45rem 1.1rem;
      border-radius:9px; cursor:pointer; transition:all 0.2s;
    }
    .nav-back:hover { color:var(--text); border-color:rgba(255,255,255,0.2); }

    /* ‚îÄ‚îÄ APP SHELL ‚îÄ‚îÄ */
    .app {
      display:grid;
      grid-template-columns: 420px 1fr;
      height: calc(100vh - 64px);
      margin-top: 64px;
    }

    /* ‚îÄ‚îÄ LEFT PANEL ‚îÄ‚îÄ */
    .left {
      background:var(--surf);
      border-right:1px solid var(--border);
      display:flex; flex-direction:column;
      overflow-y:auto;
      height:100%;
    }

    /* scrollbar */
    .left::-webkit-scrollbar { width:4px; }
    .left::-webkit-scrollbar-track { background:transparent; }
    .left::-webkit-scrollbar-thumb { background:rgba(255,255,255,0.1); border-radius:99px; }

    .panel-head {
      padding:2.25rem 2rem 1.75rem;
      border-bottom:1px solid var(--border); flex-shrink:0;
    }
    .panel-head h1 {
      font-family:var(--head); font-size:2rem; font-weight:800;
      line-height:1.15; letter-spacing:-0.03em; margin-bottom:0.75rem;
    }
    .panel-head p { font-size:1rem; color:var(--muted); line-height:1.7; font-weight:400; }

    /* UPLOAD */
    .upload-zone {
      margin:1.5rem; flex-shrink:0;
      border:2px dashed rgba(0,229,160,0.28); border-radius:18px;
      padding:2.75rem 1.75rem; text-align:center; cursor:pointer;
      transition:all 0.3s; background:rgba(0,229,160,0.025);
      position:relative; overflow:hidden;
    }
    .upload-zone::before {
      content:''; position:absolute; inset:0;
      background:radial-gradient(circle at 50% 50%, rgba(0,229,160,0.07), transparent 70%);
      opacity:0; transition:opacity 0.3s;
    }
    .upload-zone:hover { border-color:rgba(0,229,160,0.55); }
    .upload-zone:hover::before { opacity:1; }
    .upload-zone.dragover { border-color:var(--green); background:rgba(0,229,160,0.07); }

    .u-icon {
      width:72px; height:72px; border-radius:50%; background:var(--gdim);
      display:flex; align-items:center; justify-content:center;
      font-size:2rem; margin:0 auto 1.4rem;
    }
    .upload-zone h3 { font-family:var(--head); font-size:1.2rem; font-weight:700; margin-bottom:0.5rem; }
    .upload-zone p  { font-size:0.95rem; color:var(--muted); margin-bottom:1.4rem; }
    .btn-browse {
      font-family:var(--head); font-size:0.95rem; font-weight:700;
      padding:0.65rem 1.75rem; background:var(--green); color:#080c10;
      border:none; border-radius:10px; cursor:pointer; transition:all 0.2s;
      letter-spacing:0.01em;
    }
    .btn-browse:hover { transform:translateY(-2px); box-shadow:0 8px 24px rgba(0,229,160,0.4); }

    /* DIVIDER */
    .div-row { display:flex; align-items:center; gap:1rem; padding:0.5rem 1.5rem; flex-shrink:0; }
    .div-line { flex:1; height:1px; background:var(--border); }
    .div-row span { font-size:0.88rem; color:var(--muted); white-space:nowrap; }

    /* EXAMPLES */
    .ex-label {
      padding:0 1.5rem 0.5rem; flex-shrink:0;
      font-family:var(--head); font-size:0.8rem; font-weight:700;
      letter-spacing:0.08em; color:var(--muted); text-transform:uppercase;
    }
    .ex-grid {
      display:grid; grid-template-columns:1fr 1fr;
      gap:0.75rem; padding:0.25rem 1.5rem 1rem; flex-shrink:0;
    }
    .ex-card {
      background:rgba(255,255,255,0.025); border:1px solid var(--border);
      border-radius:14px; padding:1.1rem 0.75rem; cursor:pointer;
      transition:all 0.25s; display:flex; flex-direction:column;
      align-items:center; text-align:center; gap:0.4rem;
      position:relative; overflow:hidden;
    }
    .ex-card::after {
      content:''; position:absolute; inset:0;
      background:radial-gradient(circle at 50% 0%, var(--glow,rgba(0,229,160,0.1)), transparent 70%);
      opacity:0; transition:opacity 0.3s;
    }
    .ex-card:hover { border-color:var(--cc,var(--green)); transform:translateY(-3px); }
    .ex-card:hover::after { opacity:1; }
    .ex-card.active { border-color:var(--cc,var(--green)); background:rgba(0,229,160,0.06); }
    .ex-card .em  { font-size:1.9rem; }
    .ex-card .lbl { font-family:var(--head); font-size:0.88rem; font-weight:700; }
    .ex-card .sub { font-size:0.78rem; color:var(--muted); }

    /* CAPABILITY PILLS */
    .caps {
      padding:1.25rem 1.5rem; margin-top:auto; border-top:1px solid var(--border); flex-shrink:0;
    }
    .caps h4 {
      font-family:var(--head); font-size:0.78rem; font-weight:700;
      letter-spacing:0.08em; color:var(--muted); text-transform:uppercase; margin-bottom:0.85rem;
    }
    .pills { display:flex; flex-wrap:wrap; gap:0.5rem; }
    .pill {
      display:flex; align-items:center; gap:0.4rem;
      padding:0.35rem 0.8rem; border-radius:99px;
      font-size:0.82rem; font-weight:500;
      border:1px solid var(--border); color:var(--muted);
    }
    .pill .dot { width:6px; height:6px; border-radius:50%; }

    /* ‚îÄ‚îÄ RIGHT PANEL ‚îÄ‚îÄ */
    .right {
      background:var(--bg);
      display:flex; flex-direction:column;
      height:100%; overflow:hidden;
    }

    /* IDLE */
    .idle {
      flex:1; display:flex; flex-direction:column;
      align-items:center; justify-content:center;
      gap:1.75rem; padding:3rem; text-align:center;
    }
    .idle-vis { position:relative; width:200px; height:200px; }
    .ring {
      position:absolute; inset:0; border-radius:50%;
      border:2px solid var(--border);
      animation:rspin 12s linear infinite;
    }
    .ring:nth-child(2) { inset:16px; border-color:rgba(0,229,160,0.15); animation-duration:8s; animation-direction:reverse; }
    .ring:nth-child(3) { inset:32px; border-color:rgba(167,139,250,0.15); animation-duration:6s; }
    .ring-center { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size:4rem; }
    @keyframes rspin { from{transform:rotate(0deg);} to{transform:rotate(360deg);} }
    .idle h2 { font-family:var(--head); font-size:1.7rem; font-weight:700; color:var(--muted); letter-spacing:-0.02em; }
    .idle p  { font-size:1.05rem; color:var(--muted); max-width:360px; line-height:1.7; }

    /* LOADING */
    .loading {
      display:none; flex:1; flex-direction:column;
      align-items:center; justify-content:center;
      gap:2rem; padding:3rem; text-align:center;
    }
    .scan-wrap { position:relative; width:340px; height:260px; }
    .scan-frame {
      position:absolute; inset:0;
      border:2px solid rgba(0,229,160,0.3); border-radius:18px; overflow:hidden;
    }
    .scan-line {
      position:absolute; left:0; right:0; height:3px;
      background:linear-gradient(90deg,transparent,var(--green),transparent);
      box-shadow:0 0 22px var(--green);
      animation:scanAnim 2s ease-in-out infinite;
    }
    @keyframes scanAnim { 0%{top:0;} 50%{top:calc(100% - 3px);} 100%{top:0;} }
    .corners span { position:absolute; width:22px; height:22px; border-color:var(--green); border-style:solid; border-width:0; }
    .corners span:nth-child(1) { top:0;left:0; border-top-width:3px; border-left-width:3px; border-radius:5px 0 0 0; }
    .corners span:nth-child(2) { top:0;right:0; border-top-width:3px; border-right-width:3px; border-radius:0 5px 0 0; }
    .corners span:nth-child(3) { bottom:0;left:0; border-bottom-width:3px; border-left-width:3px; border-radius:0 0 0 5px; }
    .corners span:nth-child(4) { bottom:0;right:0; border-bottom-width:3px; border-right-width:3px; border-radius:0 0 5px 0; }
    .scan-preview { width:100%; height:100%; object-fit:cover; border-radius:16px; filter:brightness(0.4); }
    .load-label { font-family:var(--head); font-size:1.2rem; font-weight:700; color:var(--green); letter-spacing:-0.01em; }
    .steps { display:flex; flex-direction:column; gap:0.85rem; min-width:300px; }
    .step { display:flex; align-items:center; gap:0.85rem; font-size:0.98rem; color:var(--muted); transition:color 0.3s; font-weight:400; }
    .step.done   { color:var(--text); }
    .step.active { color:var(--green); }
    .step-num { width:24px; height:24px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:0.75rem; font-family:var(--head); font-weight:700; background:var(--border); flex-shrink:0; transition:all 0.3s; }
    .step.done   .step-num { background:var(--green); color:#080c10; }
    .step.active .step-num { background:var(--gdim); color:var(--green); border:1px solid var(--green); }

    /* RESULT */
    .result { display:none; flex-direction:column; height:100%; overflow:hidden; }

    /* toolbar */
    .r-toolbar {
      display:flex; align-items:center; justify-content:space-between;
      padding:1rem 2rem; border-bottom:1px solid var(--border); flex-shrink:0;
    }
    .breadcrumb { display:flex; align-items:center; gap:0.5rem; font-size:0.95rem; color:var(--muted); font-weight:500; }
    .breadcrumb .sep { opacity:0.35; }
    .breadcrumb .cur { font-family:var(--head); font-size:0.95rem; font-weight:700; color:var(--text); }

    .sev-badge { display:flex; align-items:center; gap:0.5rem; padding:0.4rem 1.1rem; border-radius:99px; font-family:var(--head); font-size:0.88rem; font-weight:700; }
    .sev-badge.high     { background:rgba(255,76,106,0.14);  color:var(--red);    border:1px solid rgba(255,76,106,0.3); }
    .sev-badge.medium   { background:rgba(245,166,35,0.14);  color:var(--amber);  border:1px solid rgba(245,166,35,0.3); }
    .sev-badge.low      { background:var(--gdim);            color:var(--green);  border:1px solid rgba(0,229,160,0.3); }
    .sev-badge.critical { background:rgba(255,23,68,0.18);   color:#ff1744;       border:1px solid rgba(255,23,68,0.4); }
    .pdot { width:7px; height:7px; border-radius:50%; background:currentColor; animation:blink 1.4s infinite; }
    @keyframes blink { 0%,100%{opacity:1;} 50%{opacity:0.2;} }

    /* canvas area */
    .canvas-area {
      flex:1; position:relative;
      background:#04070a;
      display:flex; align-items:center; justify-content:center;
      overflow:hidden; min-height:0;
    }
    #aImg { max-width:100%; max-height:100%; object-fit:contain; display:block; }
    #oCvs { position:absolute; top:0; left:0; pointer-events:none; }

    .live-badge {
      position:absolute; top:1.1rem; left:1.1rem;
      display:flex; align-items:center; gap:0.5rem;
      background:rgba(8,12,16,0.88); border:1px solid var(--green);
      border-radius:9px; padding:0.45rem 0.85rem;
      font-family:var(--head); font-size:0.82rem; font-weight:600; color:var(--green);
      backdrop-filter:blur(8px);
    }

    /* metrics strip */
    .metrics {
      border-top:1px solid var(--border);
      padding:1.25rem 2rem;
      display:grid; grid-template-columns:repeat(4,1fr) 1.5fr;
      gap:1rem; align-items:center; flex-shrink:0;
    }
    .metric { display:flex; flex-direction:column; gap:0.3rem; }
    .m-label { font-family:var(--head); font-size:0.72rem; font-weight:700; letter-spacing:0.08em; color:var(--muted); text-transform:uppercase; }
    .m-val   { font-family:var(--head); font-size:1.15rem; font-weight:800; letter-spacing:-0.01em; }
    .m-val.g { color:var(--green); }
    .m-val.a { color:var(--amber); }
    .m-val.r { color:var(--red); }
    .act { display:flex; flex-direction:column; gap:0.55rem; }
    .btn-rep {
      font-family:var(--head); font-size:0.9rem; font-weight:700;
      padding:0.7rem 1.3rem; background:var(--green); color:#080c10;
      border:none; border-radius:10px; cursor:pointer; transition:all 0.2s; text-align:center; letter-spacing:0.01em;
    }
    .btn-rep:hover { transform:translateY(-2px); box-shadow:0 6px 20px rgba(0,229,160,0.4); }
    .btn-map {
      font-family:var(--head); font-size:0.9rem; font-weight:600;
      padding:0.7rem 1.3rem; background:none; color:var(--text);
      border:1px solid var(--border); border-radius:10px; cursor:pointer; transition:all 0.2s; text-align:center;
    }
    .btn-map:hover { border-color:rgba(255,255,255,0.25); }

    /* detections list */
    .det-list {
      border-top:1px solid var(--border);
      padding:1.1rem 2rem 1.4rem;
      display:flex; flex-direction:column; gap:0.55rem;
      flex-shrink:0; overflow-y:auto; max-height:200px;
    }
    .det-list-head {
      font-family:var(--head); font-size:0.78rem; font-weight:700;
      letter-spacing:0.08em; color:var(--muted); text-transform:uppercase; margin-bottom:0.25rem;
    }
    .det-row {
      display:grid; grid-template-columns:10px 1fr auto auto;
      align-items:center; gap:0.75rem;
      padding:0.65rem 0.85rem; border-radius:10px;
      background:rgba(255,255,255,0.02); border:1px solid var(--border);
      font-size:0.92rem; cursor:pointer; transition:all 0.2s;
    }
    .det-row:hover { border-color:rgba(255,255,255,0.16); background:rgba(255,255,255,0.04); }
    .d-col { width:8px; height:8px; border-radius:50%; }
    .d-lbl { font-weight:600; }
    .d-conf { font-size:0.82rem; color:var(--muted); font-family:monospace; }
    .d-bge { font-size:0.75rem; padding:0.18rem 0.55rem; border-radius:5px; font-weight:700; }
    .d-bge     { background:rgba(255,76,106,0.14); color:var(--red); }
    .d-bge.med { background:rgba(245,166,35,0.14);  color:var(--amber); }
    .d-bge.low { background:var(--gdim);            color:var(--green); }

    /* toast */
    .toast {
      position:fixed; bottom:2rem; right:2rem; z-index:9000;
      background:var(--surf); border:1px solid var(--green); border-radius:14px;
      padding:1.1rem 1.6rem; display:flex; align-items:center; gap:0.85rem;
      box-shadow:0 8px 32px rgba(0,0,0,0.45);
      transform:translateY(130%); opacity:0;
      transition:all 0.4s cubic-bezier(0.34,1.56,0.64,1); max-width:360px;
    }
    .toast.show { transform:translateY(0); opacity:1; }
    .t-icon { font-size:1.5rem; }
    .t-text strong { display:block; font-family:var(--head); font-size:1rem; font-weight:700; }
    .t-text span   { font-size:0.88rem; color:var(--muted); }

    @media (max-width:900px) {
      body { overflow:auto; }
      .app { grid-template-columns:1fr; height:auto; }
      .left { height:auto; max-height:none; }
      .right { height:auto; min-height:100vh; overflow:visible; }
      .canvas-area { min-height:350px; }
      .metrics { grid-template-columns:1fr 1fr; }
      .act { grid-column:1/-1; flex-direction:row; }
    }
  </style>
</head>
<body>

<nav>
  <a class="nav-logo" href="sustainx.html">üåø SustainX</a>
  <div class="nav-right">
    <span class="nav-tag">‚óè AI Detection Live</span>
    <button class="nav-back" onclick="window.location.href='home.html'">‚Üê Home</button>
  </div>
</nav>

<div class="app">

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LEFT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <aside class="left">
    <div class="panel-head">
      <h1>Smart Image<br>Detection</h1>
      <p>Upload any environmental photo. Our AI analyzes it in real‚Äëtime, highlights detected issues with bounding boxes, and generates a severity report instantly.</p>
    </div>

    <div class="upload-zone" id="uploadZone">
      <div class="u-icon">üì§</div>
      <h3>Drop your image here</h3>
      <p>JPG, PNG, WEBP ¬∑ Max 10 MB</p>
      <button class="btn-browse" onclick="event.stopPropagation(); document.getElementById('fi').click()">Browse Files</button>
      <input type="file" id="fi" accept="image/*" style="display:none"/>
    </div>

    <div class="div-row">
      <div class="div-line"></div>
      <span>or try an example</span>
      <div class="div-line"></div>
    </div>

    <p class="ex-label">Example Scenarios</p>

    <div class="ex-grid">
      <div class="ex-card" data-t="garbage" style="--cc:#ff4c6a;--glow:rgba(255,76,106,0.12)" onclick="go('garbage')">
        <span class="em">üóëÔ∏è</span><span class="lbl">Garbage</span><span class="sub">Litter & Waste</span>
      </div>
      <div class="ex-card" data-t="water"   style="--cc:#38bdf8;--glow:rgba(56,189,248,0.12)"  onclick="go('water')">
        <span class="em">üíß</span><span class="lbl">Water Pollution</span><span class="sub">Oil spills & Foam</span>
      </div>
      <div class="ex-card" data-t="road"    style="--cc:#f5a623;--glow:rgba(245,166,35,0.12)"  onclick="go('road')">
        <span class="em">üõ£Ô∏è</span><span class="lbl">Road Crack</span><span class="sub">Pavement damage</span>
      </div>
      <div class="ex-card" data-t="forest"  style="--cc:#a78bfa;--glow:rgba(167,139,250,0.12)" onclick="go('forest')">
        <span class="em">üå≥</span><span class="lbl">Deforestation</span><span class="sub">Tree loss</span>
      </div>
      <div class="ex-card" data-t="air"     style="--cc:#e879f9;--glow:rgba(232,121,249,0.12)" onclick="go('air')">
        <span class="em">üè≠</span><span class="lbl">Air Pollution</span><span class="sub">Smog & Dust</span>
      </div>
      <div class="ex-card" data-t="wildlife" style="--cc:#00e5a0;--glow:rgba(0,229,160,0.12)"  onclick="go('wildlife')">
        <span class="em">ü¶ã</span><span class="lbl">Wildlife</span><span class="sub">Species monitoring</span>
      </div>
    </div>

    <div class="caps">
      <h4>Detection Capabilities</h4>
      <div class="pills">
        <div class="pill"><div class="dot" style="background:#ff4c6a"></div>Object Detection</div>
        <div class="pill"><div class="dot" style="background:#f5a623"></div>Segmentation</div>
        <div class="pill"><div class="dot" style="background:#00e5a0"></div>Classification</div>
        <div class="pill"><div class="dot" style="background:#38bdf8"></div>Severity Score</div>
        <div class="pill"><div class="dot" style="background:#a78bfa"></div>Geo-tagging</div>
      </div>
    </div>
  </aside>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê RIGHT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <section class="right" id="right">

    <!-- IDLE -->
    <div class="idle" id="idle">
      <div class="idle-vis">
        <div class="ring"></div>
        <div class="ring"></div>
        <div class="ring"></div>
        <div class="ring-center">üåç</div>
      </div>
      <h2>Awaiting Image</h2>
      <p>Upload a photo or select an example on the left to start AI environmental analysis.</p>
    </div>

    <!-- LOADING -->
    <div class="loading" id="loading">
      <div class="scan-wrap">
        <div class="scan-frame">
          <img id="sPrev" class="scan-preview" src="" alt=""/>
          <div class="scan-line"></div>
          <div class="corners"><span></span><span></span><span></span><span></span></div>
        </div>
      </div>
      <div class="load-label" id="loadLbl">Initializing AI model...</div>
      <div class="steps">
        <div class="step" id="s1"><div class="step-num">1</div>Preprocessing image</div>
        <div class="step" id="s2"><div class="step-num">2</div>Running object detection</div>
        <div class="step" id="s3"><div class="step-num">3</div>Analyzing severity</div>
        <div class="step" id="s4"><div class="step-num">4</div>Generating report</div>
      </div>
    </div>

    <!-- RESULT -->
    <div class="result" id="result">
      <div class="r-toolbar">
        <div class="breadcrumb">
          <span>SustainX</span><span class="sep">‚Ä∫</span>
          <span>Detection</span><span class="sep">‚Ä∫</span>
          <span class="cur" id="rType">‚Äî</span>
        </div>
        <div class="sev-badge high" id="sevBadge">
          <div class="pdot"></div>
          <span id="sevTxt">‚Äî</span>
        </div>
      </div>

      <div class="canvas-area">
        <img id="aImg" src="" alt=""/>
        <canvas id="oCvs"></canvas>
        <div class="live-badge"><div class="pdot"></div>AI Detection Active</div>
      </div>

      <div class="metrics">
        <div class="metric"><div class="m-label">Problem Type</div><div class="m-val g" id="mType">‚Äî</div></div>
        <div class="metric"><div class="m-label">Confidence</div><div class="m-val g" id="mConf">‚Äî</div></div>
        <div class="metric"><div class="m-label">Objects Found</div><div class="m-val a" id="mCnt">‚Äî</div></div>
        <div class="metric"><div class="m-label">Risk Level</div><div class="m-val r" id="mRisk">‚Äî</div></div>
        <div class="act">
          <button class="btn-rep" onclick="report()">üìç Report to Authorities</button>
          <button class="btn-map" onclick="window.location.href='heatmap.html'">üó∫Ô∏è View on Heatmap</button>
        </div>
      </div>

      <div class="det-list">
        <div class="det-list-head">Detected Objects</div>
        <div id="dRows"></div>
      </div>
    </div>

  </section>
</div>

<div class="toast" id="toast">
  <div class="t-icon">‚úÖ</div>
  <div class="t-text">
    <strong>Report Submitted!</strong>
    <span>Authorities notified ¬∑ +25 SustainX points earned</span>
  </div>
</div>

<script>
const DB = {
  garbage:  { label:'Garbage / Litter',   sev:'high',     sevT:'HIGH RISK',   conf:'94.2%', risk:'High',     col:'#ff4c6a', objs:[{l:'Plastic Bottles',c:'96%',s:'high',x:8,y:10,w:28,h:22},{l:'Trash Bag',c:'91%',s:'high',x:44,y:34,w:22,h:30},{l:'Cardboard',c:'88%',s:'med',x:68,y:16,w:20,h:20},{l:'Organic Waste',c:'82%',s:'low',x:20,y:60,w:18,h:18}]},
  water:    { label:'Water Pollution',     sev:'medium',   sevT:'MEDIUM RISK', conf:'87.5%', risk:'Medium',   col:'#38bdf8', objs:[{l:'Oil Spill',c:'89%',s:'high',x:12,y:18,w:42,h:32},{l:'Foam / Algae',c:'84%',s:'med',x:58,y:34,w:26,h:22},{l:'Plastic Debris',c:'79%',s:'med',x:28,y:60,w:22,h:18}]},
  road:     { label:'Road Crack',          sev:'medium',   sevT:'MEDIUM RISK', conf:'91.8%', risk:'Moderate', col:'#f5a623', objs:[{l:'Longitudinal Crack',c:'93%',s:'high',x:18,y:28,w:62,h:10},{l:'Pothole',c:'88%',s:'high',x:35,y:52,w:20,h:18},{l:'Surface Erosion',c:'76%',s:'med',x:64,y:66,w:22,h:16}]},
  forest:   { label:'Deforestation',       sev:'critical', sevT:'CRITICAL',    conf:'96.3%', risk:'Critical', col:'#a78bfa', objs:[{l:'Cleared Forest',c:'97%',s:'high',x:4,y:4,w:55,h:52},{l:'Bare Soil Patch',c:'94%',s:'high',x:62,y:8,w:32,h:42},{l:'Tree Line Boundary',c:'91%',s:'med',x:8,y:62,w:82,h:14}]},
  air:      { label:'Air Pollution',       sev:'high',     sevT:'HIGH RISK',   conf:'83.6%', risk:'High',     col:'#e879f9', objs:[{l:'Dense Smog Layer',c:'85%',s:'high',x:0,y:0,w:100,h:42},{l:'Industrial Plume',c:'82%',s:'high',x:22,y:18,w:32,h:58},{l:'Particulate Matter',c:'78%',s:'med',x:60,y:28,w:36,h:30}]},
  wildlife: { label:'Wildlife Issue',      sev:'low',      sevT:'MONITORING',  conf:'88.9%', risk:'Low',      col:'#00e5a0', objs:[{l:'Species Detected',c:'90%',s:'low',x:24,y:18,w:36,h:46},{l:'Habitat Degradation',c:'85%',s:'med',x:64,y:8,w:32,h:30},{l:'Invasive Plant',c:'81%',s:'med',x:8,y:64,w:28,h:26}]}
};

const fi        = document.getElementById('fi');
const uZone     = document.getElementById('uploadZone');
const idleEl    = document.getElementById('idle');
const loadEl    = document.getElementById('loading');
const resultEl  = document.getElementById('result');
const sPrev     = document.getElementById('sPrev');
const aImg      = document.getElementById('aImg');
const oCvs      = document.getElementById('oCvs');
const ctx       = oCvs.getContext('2d');

fi.addEventListener('change', e => { if(e.target.files[0]) analyze(URL.createObjectURL(e.target.files[0]),'garbage'); });
uZone.addEventListener('dragover',  e => { e.preventDefault(); uZone.classList.add('dragover'); });
uZone.addEventListener('dragleave', ()=> uZone.classList.remove('dragover'));
uZone.addEventListener('drop', e => {
  e.preventDefault(); uZone.classList.remove('dragover');
  if(e.dataTransfer.files[0]) analyze(URL.createObjectURL(e.dataTransfer.files[0]),'garbage');
});

function go(type) {
  document.querySelectorAll('.ex-card').forEach(c => c.classList.remove('active'));
  document.querySelector(`.ex-card[data-t="${type}"]`).classList.add('active');
  const cvs = document.createElement('canvas');
  cvs.width=800; cvs.height=500;
  const c2=cvs.getContext('2d');
  const g=c2.createLinearGradient(0,0,800,500);
  g.addColorStop(0,'#101820'); g.addColorStop(1,'#080c10');
  c2.fillStyle=g; c2.fillRect(0,0,800,500);
  c2.fillStyle='rgba(255,255,255,0.025)'; c2.fillRect(0,0,800,500);
  c2.font='bold 14px sans-serif'; c2.fillStyle='rgba(255,255,255,0.1)';
  c2.textAlign='center'; c2.fillText(DB[type].label.toUpperCase()+' ‚Äî SAMPLE SCENE',400,255);
  analyze(cvs.toDataURL(), type);
}

function analyze(src, type) {
  idleEl.style.display='none'; loadEl.style.display='flex'; resultEl.style.display='none';
  sPrev.src = src;
  const sids = ['s1','s2','s3','s4'];
  const lbls = ['Preprocessing image...','Running object detection...','Analyzing severity...','Generating report...'];
  sids.forEach((s,i) => { const el=document.getElementById(s); el.className='step'; el.querySelector('.step-num').textContent=i+1; });
  let i=0;
  const lbl = document.getElementById('loadLbl');
  (function advance() {
    if(i>0){ const p=document.getElementById(sids[i-1]); p.className='step done'; p.querySelector('.step-num').textContent='‚úì'; }
    if(i<sids.length){
      document.getElementById(sids[i]).className='step active';
      lbl.textContent=lbls[i]; i++;
      setTimeout(advance, 550+Math.random()*350);
    } else { setTimeout(()=>showResult(src,type),400); }
  })();
}

function showResult(src, type) {
  const d = DB[type];
  loadEl.style.display='none'; resultEl.style.display='flex';
  document.getElementById('rType').textContent   = d.label;
  const badge = document.getElementById('sevBadge');
  badge.className = 'sev-badge '+d.sev;
  document.getElementById('sevTxt').textContent  = d.sevT;
  document.getElementById('mType').textContent   = d.label;
  document.getElementById('mConf').textContent   = d.conf;
  document.getElementById('mCnt').textContent    = d.objs.length+' objects';
  document.getElementById('mRisk').textContent   = d.risk;
  document.getElementById('mRisk').className     = 'm-val '+(['Critical','High'].includes(d.risk)?'r':d.risk==='Medium'?'a':'g');

  aImg.onload = () => drawBoxes(d);
  aImg.src = src;

  const rows = document.getElementById('dRows');
  rows.innerHTML='';
  d.objs.forEach(o => {
    const c=o.s==='high'?'':o.s==='med'?'med':'low';
    const t=o.s==='high'?'High':o.s==='med'?'Medium':'Low';
    rows.innerHTML+=`<div class="det-row"><div class="d-col" style="background:${d.col}"></div><span class="d-lbl">${o.l}</span><span class="d-conf">${o.c}</span><span class="d-bge ${c}">${t}</span></div>`;
  });
}

function drawBoxes(d) {
  const dw=aImg.clientWidth, dh=aImg.clientHeight;
  if(!dw||!dh){ requestAnimationFrame(()=>drawBoxes(d)); return; }
  oCvs.width=dw; oCvs.height=dh;
  oCvs.style.cssText=`width:${dw}px;height:${dh}px`;
  ctx.clearRect(0,0,dw,dh);
  d.objs.forEach(o => {
    const x=(o.x/100)*dw, y=(o.y/100)*dh, w=(o.w/100)*dw, h=(o.h/100)*dh;
    ctx.fillStyle=d.col+'1a'; ctx.fillRect(x,y,w,h);
    ctx.strokeStyle=d.col; ctx.lineWidth=2; ctx.setLineDash([6,4]); ctx.strokeRect(x,y,w,h);
    ctx.setLineDash([]); ctx.lineWidth=3;
    const cl=14;
    [[x,y,'tl'],[x+w,y,'tr'],[x,y+h,'bl'],[x+w,y+h,'br']].forEach(([cx,cy,c]) => {
      ctx.beginPath(); ctx.strokeStyle=d.col;
      if(c==='tl'||c==='bl'){ ctx.moveTo(cx,cy); ctx.lineTo(cx+cl,cy); } else { ctx.moveTo(cx,cy); ctx.lineTo(cx-cl,cy); }
      if(c==='tl'||c==='tr'){ ctx.moveTo(cx,cy); ctx.lineTo(cx,cy+cl); } else { ctx.moveTo(cx,cy); ctx.lineTo(cx,cy-cl); }
      ctx.stroke();
    });
    ctx.font='bold 12px Plus Jakarta Sans, sans-serif';
    const tw=ctx.measureText(o.l+'  '+o.c).width+18;
    ctx.fillStyle=d.col;
    ctx.beginPath();
    if(ctx.roundRect) ctx.roundRect(x,y-24,tw,22,[4,4,0,0]); else ctx.rect(x,y-24,tw,22);
    ctx.fill();
    ctx.fillStyle='#080c10'; ctx.fillText(o.l+'  '+o.c, x+9, y-7);
  });
}

window.addEventListener('resize', () => {
  if(resultEl.style.display==='flex') {
    const t=document.getElementById('mType').textContent;
    const d=Object.values(DB).find(v=>v.label===t);
    if(d) drawBoxes(d);
  }
});

function report() {
  const t=document.getElementById('toast');
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),4000);
}
</script>
</body>
</html>